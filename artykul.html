<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WEB SPACE STATION</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@200;400;600;800&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <canvas id="starfield"></canvas>
    
    <nav>
        <a href="index.html" class="nav-logo">Web Space Station</a>
        <div class="nav-links">
            <a href="index.html#meldunki">Meldunki</a>
            <a href="index.html#popularne">Nauka</a>
            <a href="index.html#tech">Technologia</a>
            <a href="index.html#status">Live</a>
        </div>
    </nav>

    <main class="article-container" style="
        background: rgba(10, 10, 15, 0.85); 
        padding: 40px; 
        border-radius: 20px; 
        border: 1px solid rgba(0, 243, 255, 0.1); 
        backdrop-filter: blur(15px); 
        margin: 120px auto 60px auto; 
        max-width: 900px;
        box-shadow: 0 0 40px rgba(0, 0, 0, 0.8);
    ">
        <span id="art-tag" class="art-tag">Ładowanie danych...</span>
        <h1 id="art-tytul" style="font-family:'Rajdhani'; font-size: 3rem; margin: 10px 0; text-transform: uppercase; color: var(--neon-cyan); text-shadow: 0 0 15px rgba(0, 243, 255, 0.3);">---</h1>
        
        <div style="position: relative; overflow: hidden; border-radius: 15px; margin: 30px 0; border: 1px solid rgba(255,255,255,0.1);">
            <img id="art-img" src="" class="full-art-img" style="width: 100%; display: block;">
        </div>

        <div id="art-tresc" class="article-body" style="font-size: 1.15rem; line-height: 1.9; color: #e0e0e0; font-weight: 300;"></div>
    </main>
    
    <section class="logs-container" style="margin-bottom: 80px;">
        <h2 class="section-title">Więcej z tego działu</h2>
        
        <div class="slider-wrapper">
            <button class="slider-arrow left" onclick="scrollSlider('track-more', -400)">&#10094;</button>
            <div class="slider-viewport" id="track-more">
                </div>
            <button class="slider-arrow right" onclick="scrollSlider('track-more', 400)">&#10095;</button>
        </div>

        <div class="slider-progress-container">
            <div class="slider-progress-bar" id="bar-more"></div>
        </div>

        <div style="text-align: center; margin-top: 50px;">
            <a href="archiwum.html" class="filter-btn" style="
                text-decoration: none; 
                display: inline-block; 
                padding: 15px 40px; 
                border: 1px solid var(--neon-cyan); 
                color: var(--neon-cyan);
                background: rgba(0, 243, 255, 0.05);
                font-family: 'Rajdhani';
                letter-spacing: 2px;
                transition: 0.3s;
            " onmouseover="this.style.background='var(--neon-cyan)'; this.style.color='#000';" onmouseout="this.style.background='rgba(0, 243, 255, 0.05)'; this.style.color='var(--neon-cyan)';">
                OTWÓRZ PEŁNE ARCHIWUM STACJI
            </a>
        </div>
    </section>

    <footer>|| WEB SPACE STATION ||</footer>

    <script src="Artykuly/artykuly.js"></script>
    <script src="stars.js"></script>

    <script>
        // --- LOGIKA ŁADOWANIA TREŚCI ---
        function loadArticle() {
            const params = new URLSearchParams(window.location.search);
            const rawId = params.get('id');

            if (typeof bazaArtykulow === 'undefined') {
                document.getElementById('art-tytul').innerText = "BŁĄD SYSTEMU: BRAK BAZY";
                return;
            }

            const art = bazaArtykulow.find(a => a.id == rawId);

            if (art) {
                document.title = art.tytul + " | WEB SPACE STATION";
                document.getElementById('art-tag').innerText = art.tag + " | " + art.kategoria.toUpperCase();
                document.getElementById('art-tytul').innerText = art.tytul;
                document.getElementById('art-img').src = art.img;
                
                const trescContainer = document.getElementById('art-tresc');
                if (trescContainer) {
                    trescContainer.innerHTML = art.tresc || `<p>${art.opis}</p>`;
                }
                
                renderRelatedSlider(art.kategoria, art.id);
            } else {
                document.getElementById('art-tytul').innerText = "NIE ZNALEZIONO ARTYKUŁU";
            }
        }

        // --- RENDEROWANIE SLIDERA PODOBNYCH ---
        function renderRelatedSlider(kategoria, currentId) {
            const track = document.getElementById('track-more');
            if(!track) return;

            const podobne = bazaArtykulow.filter(item => item.kategoria === kategoria && item.id != currentId);

            if (podobne.length === 0) {
                document.querySelector('.logs-container').style.display = 'none';
                return;
            }

            track.innerHTML = podobne.map(item => `
                <div class="art-card">
                    <div class="art-img" style="background-image: url('${item.img}');"></div>
                    <div class="art-content">
                        <span class="art-tag">${item.tag}</span>
                        <h3 class="art-title">${item.tytul}</h3>
                        <p class="art-desc">${item.opis.substring(0, 100)}...</p>
                        <a href="artykul.html?id=${item.id}" class="art-link">CZYTAJ DALEJ</a>
                    </div>
                </div>
            `).join('');

            // Inicjalizacja paska po zrenderowaniu kart
            track.addEventListener('scroll', updateProgressBar);
            updateProgressBar(); // ustawienie początkowe
        }

        // --- OBSŁUGA SLIDERA I PASKA POSTĘPU ---
        function scrollSlider(viewportId, distance) {
            const viewport = document.getElementById(viewportId);
            if(viewport) viewport.scrollBy({ left: distance, behavior: 'smooth' });
        }

        function updateProgressBar() {
            const track = document.getElementById('track-more');
            const bar = document.getElementById('bar-more');
            if (track && bar) {
                const maxScroll = track.scrollWidth - track.clientWidth;
                const scrollPercentage = maxScroll > 0 ? (track.scrollLeft / maxScroll) * 100 : 0;
                bar.style.width = scrollPercentage + "%";
            }
        }

        // --- START ---
        window.onload = function() {
            loadArticle();
        };
    </script>
</body>
</html>