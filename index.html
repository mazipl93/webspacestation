<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WEB SPACE STATION</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@200;400;600;800&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">

   <link rel="stylesheet" href="style.css">
</head>
<body>

    <canvas id="starfield"></canvas>

    <nav>
        <a href="#" class="nav-logo">Web Space Station</a>
        <div class="nav-links">
            <a href="#meldunki">Meldunki</a>
            <a href="#popularne">Nauka</a>
            <a href="#tech">Technologia</a>
            <a href="#status">Live</a>
        </div>
    </nav>

    <section class="hero">
        <div class="quote-container"><span id="quote-text">Synchronizacja bazy danych...</span></div>
        <h1 class="nebula-title">WEB SPACE<br>STATION</h1>
    </section>

    <section id="meldunki" class="logs-container">
        <h2 class="section-title">Najnowsze Meldunki</h2>
        <div class="slider-viewport">
            <div class="slider-track" id="track-meldunki">
                </div>
        </div>
    </section>

    <section id="popularne" class="logs-container">
        <h2 class="section-title">Popularno-Naukowe</h2>
        <div class="slider-viewport">
            <div class="slider-track" id="track-nauka">
                </div>
        </div>
    </section>

    <section id="tech" class="logs-container">
        <h2 class="section-title">Technologia</h2>
        <div class="slider-viewport">
            <div class="slider-track" id="track-tech">
                </div>
        </div>
    </section>

    <section id="status" class="telemetry">
        <h2 class="section-title">Centrum Kontroli LIVE</h2>
        <div class="mon-grid">
    <div class="mon-box">
        <div class="live-label">Pozycja ISS</div>
        <div id="iss-lat" class="live-value">0.0000</div>
        <div class="live-label">Szerokość</div>
        <div id="iss-lon" class="live-value">0.0000</div>
        <div class="live-label">Długość</div>
        <div class="status-info">Prędkość: <b id="iss-vel">0</b> km/h<br>Wysokość: <b id="iss-alt">0</b> km</div>
    </div>

    <div class="mon-box" id="next-launch-box">
        <div class="live-label">Najbliższy Start</div>
        <div id="launch-timer" class="live-value" style="color:var(--neon-yellow); font-size: 1.4rem;">ŁADOWANIE...</div>
        <div id="launch-name" class="live-label">Szukanie misji...</div>
        <div class="status-info">Rakieta: <b id="launch-rocket">---</b><br>Miejsce: <b id="launch-pad">---</b></div>
    </div>

    <div class="mon-box">
        <div class="live-label">Obecnie w kosmosie</div>
        <div id="crew-count" class="live-value">0</div>
        <div class="live-label">Personel Orbitalny</div>
        <div class="crew-list" id="crew-list">Synchronizacja...</div>
    </div>
</div>

<div class="artemis-banner">
    <div class="mon-box" style="width: 100%; margin-top: 20px; border: 1px solid var(--neon-purple); position: relative; overflow: hidden;">
        <div class="live-label" style="text-align: center; letter-spacing: 2px;">PROGRAM ARTEMIS: POWRÓT LUDZI NA KSIĘŻYC</div>
        
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px; flex-wrap: wrap;">
            
            <div style="flex: 1; text-align: center;">
                <div class="live-label">MISJA ARTEMIS II</div>
                <div id="artemis-date" class="live-value" style="color:var(--neon-purple); font-size: 1.8rem;">---</div>
            </div>

            <div style="flex: 1; display: flex; justify-content: center; align-items: center; min-width: 150px;">
                <img src="artemis.jpg" 
                     alt="Artemis Logo" 
                     style="height: 100px; filter: drop-shadow(0 0 10px var(--neon-purple));">
            </div>

            <div style="flex: 1; text-align: center;" class="status-info">
                Status: <b id="artemis-status" style="color: #fff;">W przygotowaniu</b><br>
                Załoga: <span style="font-size: 0.9rem; display: block; margin-top: 5px;">Wiseman, Glover, Koch, Hansen</span>
            </div>

        </div>
    </div>
</div>
    </section>

    <footer>|| WEB SPACE STATION ||</footer>

    <script src="Artykuly/artykuly.js"></script>

    <script>
        // --- GWIAZDY ---
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');
        let width, height, stars = [];
        function initStars() {
            width = window.innerWidth; height = window.innerHeight;
            canvas.width = width; canvas.height = height;
            stars = [];
            for(let i=0; i<250; i++) stars.push({x: Math.random()*width, y: Math.random()*height, size: Math.random()*1.2, speed: Math.random()*0.3});
        }
        function animateStars() {
            ctx.clearRect(0,0,width,height); ctx.fillStyle = "#fff";
            stars.forEach(s => { ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI*2); ctx.fill(); s.y -= s.speed; if(s.y < 0) s.y = height; });
            requestAnimationFrame(animateStars);
        }
        initStars(); animateStars();

        // --- SENTENCJE ---
        const quotes = [
            "„Gdzieś tam coś niesamowitego czeka na odkrycie.” – Carl Sagan",
            "„Jesteśmy sposobem, w jaki kosmos poznaje samego siebie.”",
            "„Stan systemu: 08.02.2026 – Wszystkie parametry w normie.”",
            "„Eksploracja to przeznaczenie gatunku.”",
            "„Pamiętaj, by patrzeć w gwiazdy, a nie pod nogi.”",
            "„Każdy z nas jest zrobiony z gwiezdnego pyłu.”"
        ];
        let qIdx = 0;
        function rotateQuotes() {
            const el = document.getElementById('quote-text');
            if(!el) return;
            el.style.opacity = 0;
            setTimeout(() => {
                el.innerText = quotes[qIdx];
                el.style.opacity = 1;
                qIdx = (qIdx + 1) % quotes.length;
            }, 1000);
        }
        setInterval(rotateQuotes, 7000); rotateQuotes();
</script>
<script>
// --- 1. RENDEROWANIE ARTYKUŁÓW Z PLIKU JS ---
function renderujArtykuly() {
    const kontenery = {
        'meldunki': document.getElementById('track-meldunki'),
        'nauka': document.getElementById('track-nauka'),
        'tech': document.getElementById('track-tech')
    };

    if (typeof bazaArtykulow === 'undefined') {
        console.error("Błąd: Nie załadowano bazy z Artykuly/artykuly.js!");
        return;
    }

    Object.values(kontenery).forEach(k => { if(k) k.innerHTML = ""; });

    [...bazaArtykulow].reverse().forEach(art => {
        const target = kontenery[art.kategoria];
        if(!target) return;
        if(target.children.length >= 10) return;

        const card = `
            <div class="art-card">
                <div class="art-img" style="background-image: url('${art.img}');"></div>
                <div class="art-content">
                    <span class="art-tag">${art.tag}</span>
                    <h3 class="art-title">${art.tytul}</h3>
                    <p class="art-desc">${art.opis}</p>
                    <a href="${art.link}" class="art-link">CZYTAJ WIĘCEJ</a>
                </div>
            </div>
        `;
        target.innerHTML += card;
    });
    
    initSliders();
}

// --- 2. OBSŁUGA SLIDERÓW ---
function initSliders() {
    const viewports = document.querySelectorAll('.slider-viewport');
    viewports.forEach(slider => {
        let isDown = false;
        let startX;
        let scrollLeft;

        slider.addEventListener('mousedown', (e) => {
            isDown = true;
            slider.style.scrollSnapType = 'none';
            startX = e.pageX - slider.offsetLeft;
            scrollLeft = slider.scrollLeft;
        });
        slider.addEventListener('mouseleave', () => { isDown = false; });
        slider.addEventListener('mouseup', () => { 
            isDown = false; 
            slider.style.scrollSnapType = 'x mandatory';
        });
        slider.addEventListener('mousemove', (e) => {
            if (!isDown) return;
            e.preventDefault();
            const x = e.pageX - slider.offsetLeft;
            const walk = (x - startX) * 2;
            slider.scrollLeft = scrollLeft - walk;
        });
    });
}

// --- 3. DANE ISS (NA ŻYWO CO 1 SEKUNDĘ) ---
async function updateISS() {
    try {
        const res = await fetch('https://api.wheretheiss.at/v1/satellites/25544');
        const data = await res.json();
        const latEl = document.getElementById('iss-lat');
        const lonEl = document.getElementById('iss-lon');
        const velEl = document.getElementById('iss-vel');
        const altEl = document.getElementById('iss-alt');

        if(latEl) latEl.innerText = parseFloat(data.latitude).toFixed(4);
        if(lonEl) lonEl.innerText = parseFloat(data.longitude).toFixed(4);
        if(velEl) velEl.innerText = Math.round(data.velocity).toLocaleString();
        if(altEl) altEl.innerText = parseFloat(data.altitude).toFixed(1);
    } catch (e) { console.error("Błąd ISS"); }
}

// --- 4. ZAŁOGA (LIVE - POPRAWIONY LINK HTTPS) ---
async function updateCrew() {
    try {
        // Używamy alternatywnego źródła z HTTPS, bo open-notify często blokuje serwery SSL
        const res = await fetch('https://corquaid.github.io/international-space-station-api/api/v1/astros.json');
        const data = await res.json();
        const countEl = document.getElementById('crew-count');
        const listEl = document.getElementById('crew-list');

        if(countEl) countEl.innerText = data.number;
        if(listEl) {
            listEl.innerHTML = data.people.map(p => `
                <div class="crew-item"><span>${p.name}</span> <b style="color:var(--neon-cyan)">${p.craft}</b></div>
            `).join('');
        }
    } catch (e) { console.error("Błąd załogi"); }
}

// --- 5. NAJBLIŻSZY START (DOWOLNY - WYŁĄCZNIE PRZYSZŁE) ---
async function updateNextLaunch() {
    try {
        // Pobieramy z wersji produkcyjnej 'll' zamiast 'lldev'
        const res = await fetch('https://ll.thespacedevs.com/2.2.0/launch/upcoming/?limit=10');
        const data = await res.json();
        
        if (data.results && data.results.length > 0) {
            const now = new Date();
            // Szukamy misji, która odbędzie się po 08.02.2026 15:30 (Twoim aktualnym czasie)
            const futureLaunch = data.results.find(launch => new Date(launch.net) > now);

            if (futureLaunch) {
                const launchDate = new Date(futureLaunch.net);
                document.getElementById('launch-timer').innerText = launchDate.toLocaleString('pl-PL', {
                    day: '2-digit', month: '2-digit', hour: '2-digit', minute: '2-digit'
                });
                document.getElementById('launch-name').innerText = futureLaunch.name;
                document.getElementById('launch-rocket').innerText = futureLaunch.rocket.configuration.full_name;
                document.getElementById('launch-pad').innerText = futureLaunch.pad.location.name;
            } else {
                document.getElementById('launch-timer').innerText = "OCZEKIWANIE NA DANE...";
            }
        }
    } catch (e) { 
        console.error("Błąd bazy startów:", e);
        document.getElementById('launch-timer').innerText = "BŁĄD SYNCHRO";
    }
}

// --- 6. ARTEMIS II (MISJA SPECJALNA - DANE LIVE) ---
async function updateArtemis() {
    try {
        // Szukamy konkretnie misji Artemis II w całej bazie
        const res = await fetch('https://ll.thespacedevs.com/2.2.0/launch/?search=Artemis%20II&limit=1');
        const data = await res.json();
        
        const dateEl = document.getElementById('artemis-date');
        const statusEl = document.getElementById('artemis-status');

        if (data.results && data.results.length > 0) {
            const art = data.results[0];
            const artDate = new Date(art.net);
            
            // Czyste formatowanie z API
            dateEl.innerText = artDate.toLocaleDateString('pl-PL', {day:'2-digit', month:'long', year:'numeric'}).toUpperCase();
            statusEl.innerText = art.status.name.toUpperCase();
        } else {
            dateEl.innerText = "SZUKANIE MISJI...";
            statusEl.innerText = "NASA DATABASE OFFLINE";
        }
    } catch (e) { 
        console.error("Błąd Artemis API:", e);
        if(dateEl) dateEl.innerText = "BŁĄD POŁĄCZENIA";
    }
}

// --- START SYSTEMU ---
window.onload = () => {
    renderujArtykuly();
    updateISS();
    updateCrew();
    updateNextLaunch(); // Nowa funkcja!
    updateArtemis();
    
    // Odświeżaj pozycję ISS co sekundę
    setInterval(updateISS, 1000);
    // Odświeżaj info o startach co 10 minut (żeby nie blokować API)
    setInterval(updateNextLaunch, 600000);
};
</script>
</body>

</html>
